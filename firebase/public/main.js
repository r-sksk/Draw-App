(function(e){function t(t){for(var n,c,o=t[0],s=t[1],u=t[2],l=0,d=[];l<o.length;l++)c=o[l],Object.prototype.hasOwnProperty.call(i,c)&&i[c]&&d.push(i[c][0]),i[c]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n]);f&&f(t);while(d.length)d.shift()();return r.push.apply(r,u||[]),a()}function a(){for(var e,t=0;t<r.length;t++){for(var a=r[t],n=!0,o=1;o<a.length;o++){var s=a[o];0!==i[s]&&(n=!1)}n&&(r.splice(t--,1),e=c(c.s=a[0]))}return e}var n={},i={index:0},r=[];function c(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,c),a.l=!0,a.exports}c.m=e,c.c=n,c.d=function(e,t,a){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(c.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)c.d(a,n,function(t){return e[t]}.bind(null,n));return a},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],s=o.push.bind(o);o.push=t,o=o.slice();for(var u=0;u<o.length;u++)t(o[u]);var f=s;r.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("655c")},1:function(e,t){},2:function(e,t){},3:function(e,t){},"4e33":function(e,t,a){},"655c":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"l-container"},[a("Base")],1)},r=[],c=a("d4ec"),o=a("262e"),s=a("2caf"),u=a("9ab4"),f=a("60a3"),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("FabricCanvas")],1)},d=[],b=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("canvas",{attrs:{id:"fabricCavas"}})},v=[],h=function(e){Object(o["a"])(a,e);var t=Object(s["a"])(a);function a(){return Object(c["a"])(this,a),t.apply(this,arguments)}return a}(f["b"]);h=Object(u["__decorate"])([Object(f["a"])({components:{}})],h);var p=h,g=p,y=a("2877"),j=Object(y["a"])(g,b,v,!1,null,null,null),m=j.exports,O=function(e){Object(o["a"])(a,e);var t=Object(s["a"])(a);function a(){return Object(c["a"])(this,a),t.apply(this,arguments)}return a}(f["b"]);O=Object(u["__decorate"])([Object(f["a"])({components:{FabricCanvas:m}})],O);var k=O,_=k,w=Object(y["a"])(_,l,d,!1,null,null,null),F=w.exports,R=function(e){Object(o["a"])(a,e);var t=Object(s["a"])(a);function a(){return Object(c["a"])(this,a),t.apply(this,arguments)}return a}(f["b"]);R=Object(u["__decorate"])([Object(f["a"])({components:{Base:F}})],R);var I=R,C=I,x=(a("709f"),Object(y["a"])(C,i,r,!1,null,null,null)),D=x.exports,S=a("2f62"),B={firebase:{inst:void 0,app:void 0,dbPath:void 0,storageRef:void 0,boardsRef:void 0,messagesRef:void 0,objectsRef:void 0},fabric:{inst:void 0,canvas:void 0}},P=(a("4160"),a("c975"),a("bee2")),L=a("7a94"),J=function(){function e(t,a){Object(c["a"])(this,e),this.fabricCanvas=new L["fabric"].Canvas(t,a)}return Object(P["a"])(e,[{key:"getFabricInfo",value:function(){var e={inst:this,canvas:this.fabricCanvas};return e}},{key:"objectAdded",value:function(e){var t=JSON.parse(JSON.stringify(e.target)),a=V.dispatch("pushObjectsFireBase",t);a.then((function(t){void 0!==e.target&&V.commit("setFirebaseRefKey",{target:e.target,ref:t})}))}},{key:"pathCreate",value:function(e){console.log(e)}}],[{key:"init",value:function(t,a){return console.log("fabricCanvas init"),new e(t,a)}}]),e}(),A=J,E={initFirebase:function(e,t){e.firebase=t},attachFireBaseListner:function(e){var t=["child_added","child_changed","child_moved","child_removed"],a=e.firebase.inst;if(void 0!==a){var n=e.firebase.boardsRef;void 0!==n&&a.attachValueListner("value",n);var i=e.firebase.objectsRef;void 0!==i&&t.forEach((function(e){a.attachChildListner(e,i)}));var r=e.firebase.messagesRef;void 0!==r&&a.attachChildListner("child_added",r)}},initFabricJs:function(e){var t="fabricCavas",a={backgroundColor:"rgb(255, 255, 255)",isDrawingMode:!0},n=A.init(t,a);e.fabric=n.getFabricInfo()},attachFabricJsListner:function(e){var t=e.fabric.inst,a=e.fabric.canvas;void 0!==t&&void 0!==a&&a.on("path:created",(function(e){return t.pathCreate(e)}))},setFirebaseRefKey:function(e,t){var a,n,i,r=t.target,c=t.ref,o=null===(a=e.fabric.canvas)||void 0===a?void 0:a._objects.indexOf(r);void 0!==o&&(null===(i=e.fabric.canvas)||void 0===i||i._objects[o]._set("firebaseRefKey",c.key));console.log(null===(n=e.fabric.canvas)||void 0===n?void 0:n._objects)}},K=(a("99af"),a("6eba"),a("0d03"),a("ac1f"),a("5319"),a("841c"),a("8aa5")),M=a.n(K),N=function(){function e(t){Object(c["a"])(this,e),this.firebaeInit=M.a.initializeApp(t)}return Object(P["a"])(e,[{key:"getDBInfo",value:function(){var e=this.firebaeInit.database(),t=location.search.replace("?id=","");t=t||"not found";var a=this.firebaeInit.storage().ref(),n=e.ref(t),i=e.ref("".concat(t,"/messages")),r=e.ref("".concat(t,"/objects")),c={inst:this,app:this.firebaeInit,dbPath:e,storageRef:a,boardsRef:n,messagesRef:i,objectsRef:r};return c}},{key:"createBoardsRef",value:function(){var e=Date.now(),t={createdAt:e,objects:{createdAt:e},messages:{createdAt:e}},a=this.firebaeInit.database(),n=a.ref(),i=this.pushData(n,t);return i}},{key:"listenOnce",value:function(e,t){var a=this;t.once(e,(function(e){if(!1===e.exists()||null===e.key){var t=a.createBoardsRef(),n=location.origin,i="?id=".concat(t.key),r="".concat(n,"/").concat(i);location.href=r}}))}},{key:"listenOn",value:function(e,t){t.on(e,(function(e){}))}},{key:"attachValueListner",value:function(e,t){var a=e;this.listenOnce(a,t)}},{key:"attachChildListner",value:function(e,t){var a=e;this.listenOn(a,t)}},{key:"pushData",value:function(e,t){var a=e.push(t);return a}},{key:"setData",value:function(e,t,a){var n=e.child(a),i=JSON.stringify(t);n.set(i)}},{key:"deleteData",value:function(e,t){var a=e.child(t);a.remove()}},{key:"uploadImage",value:function(e,t,a){var n=e.child(a),i=n.put(t);i&&this.showProgress(i)}},{key:"showProgress",value:function(e){console.log(e)}}],[{key:"init",value:function(t){return console.log("firebase init."),new e(t)}}]),e}(),T=N,$={connectFirebase:function(e){var t={apiKey:"AIzaSyAwxa81wGhmDu_1KmoVUi48jIcxaNW5yHU",authDomain:"draw-talk.firebaseapp.com",databaseURL:"https://draw-talk.firebaseio.com",projectId:"draw-talk",storageBucket:"draw-talk.appspot.com",messagingSenderId:"920241367747",appId:"1:920241367747:web:45f7324d9619bfa92d5076",measurementId:"G-3TEQSWT2FD"},a=T.init(t),n=a.getDBInfo();e.commit("initFirebase",n)},pushObjectsFireBase:function(e,t){var a=e.state.firebase.inst,n=e.state.firebase.objectsRef;if(void 0!==a)return void 0!==n?a.pushData(n,t):void 0}},U={};n["a"].use(S["a"]);var V=new S["a"].Store({state:B,mutations:E,actions:$,getters:U,modules:{}});new n["a"]({store:V,render:function(e){return e(D)},mounted:function(){V.dispatch("connectFirebase"),V.commit("attachFireBaseListner"),V.commit("initFabricJs"),V.commit("attachFabricJsListner")}}).$mount("#app")},"709f":function(e,t,a){"use strict";a("4e33")}});