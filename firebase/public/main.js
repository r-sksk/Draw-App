(function(e){function t(t){for(var n,o,c=t[0],s=t[1],u=t[2],l=0,b=[];l<c.length;l++)o=c[l],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&b.push(r[o][0]),r[o]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n]);f&&f(t);while(b.length)b.shift()();return i.push.apply(i,u||[]),a()}function a(){for(var e,t=0;t<i.length;t++){for(var a=i[t],n=!0,c=1;c<a.length;c++){var s=a[c];0!==r[s]&&(n=!1)}n&&(i.splice(t--,1),e=o(o.s=a[0]))}return e}var n={},r={index:0},i=[];function o(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=n,o.d=function(e,t,a){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(a,n,function(t){return e[t]}.bind(null,n));return a},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],s=c.push.bind(c);c.push=t,c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var f=s;i.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("655c")},1:function(e,t){},2:function(e,t){},3:function(e,t){},"4e33":function(e,t,a){},"655c":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"l-container"},[a("router-view")],1)},i=[],o=a("d4ec"),c=a("262e"),s=a("2caf"),u=a("9ab4"),f=a("60a3"),l=function(e){Object(c["a"])(a,e);var t=Object(s["a"])(a);function a(){return Object(o["a"])(this,a),t.apply(this,arguments)}return a}(f["b"]);l=Object(u["__decorate"])([Object(f["a"])({components:{}})],l);var b=l,v=b,d=(a("709f"),a("2877")),h=Object(d["a"])(v,r,i,!1,null,null,null),p=h.exports,m=a("2f62"),j={firebase:{inst:void 0,app:void 0,dbPath:void 0,storageRef:void 0,boardsRef:void 0,messagesRef:void 0,objectsRef:void 0},fabric:{inst:void 0,canvas:void 0}},y=(a("4160"),a("c975"),a("bee2")),O=a("7a94"),g=function(){function e(t,a){Object(o["a"])(this,e),this.fabricCanvas=new O["fabric"].Canvas(t,a)}return Object(y["a"])(e,[{key:"getFabricInfo",value:function(){var e={inst:this,canvas:this.fabricCanvas};return e}},{key:"objectAdded",value:function(e){var t=JSON.parse(JSON.stringify(e.target)),a=D.dispatch("pushObjectsFireBase",t);a.then((function(t){void 0!==e.target&&D.commit("setFirebaseRefKey",{target:e.target,ref:t})}))}},{key:"pathCreate",value:function(e){console.log(e)}}],[{key:"init",value:function(t,a){return console.log("fabricCanvas init"),new e(t,a)}}]),e}(),_=g,k={initFirebase:function(e,t){e.firebase=t},attachFireBaseListner:function(e){var t=["child_added","child_changed","child_moved","child_removed"],a=e.firebase.inst;if(void 0!==a){var n=e.firebase.boardsRef;void 0!==n&&a.attachValueListner("value",n);var r=e.firebase.objectsRef;void 0!==r&&t.forEach((function(e){a.attachChildListner(e,r)}));var i=e.firebase.messagesRef;void 0!==i&&a.attachChildListner("child_added",i)}},initFabricJs:function(e){var t="fabricCavas",a={backgroundColor:"rgb(255, 255, 255)",isDrawingMode:!0},n=_.init(t,a);e.fabric=n.getFabricInfo()},attachFabricJsListner:function(e){var t=e.fabric.inst,a=e.fabric.canvas;void 0!==t&&void 0!==a&&a.on("path:created",(function(e){return t.pathCreate(e)}))},setFirebaseRefKey:function(e,t){var a,n,r,i=t.target,o=t.ref,c=null===(a=e.fabric.canvas)||void 0===a?void 0:a._objects.indexOf(i);void 0!==c&&(null===(r=e.fabric.canvas)||void 0===r||r._objects[c]._set("firebaseRefKey",o.key));console.log(null===(n=e.fabric.canvas)||void 0===n?void 0:n._objects)}},w=(a("6eba"),a("0d03"),a("8aa5")),F=a.n(w),R=function(){function e(t){Object(o["a"])(this,e),this.firebaeInit=F.a.initializeApp(t)}return Object(y["a"])(e,[{key:"getDBInfo",value:function(){var e=this.firebaeInit.database(),t=location.pathname;console.log(t);var a=this.firebaeInit.storage().ref(),n=e.ref(t),r=e.ref("".concat(t,"/messages")),i=e.ref("".concat(t,"/objects")),o={inst:this,app:this.firebaeInit,dbPath:e,storageRef:a,boardsRef:n,messagesRef:r,objectsRef:i};return o}},{key:"createBoardsRef",value:function(){var e=Date.now(),t={createdAt:e,objects:{createdAt:e},messages:{createdAt:e}},a=this.firebaeInit.database(),n=a.ref(),r=this.pushData(n,t);return r}},{key:"listenOnce",value:function(e,t){var a=this;t.once(e,(function(e){if(!1===e.exists()||null===e.key){var t=a.createBoardsRef(),n="/".concat(t.key);location.pathname=n}}))}},{key:"listenOn",value:function(e,t){t.on(e,(function(e){}))}},{key:"attachValueListner",value:function(e,t){var a=e;this.listenOnce(a,t)}},{key:"attachChildListner",value:function(e,t){var a=e;this.listenOn(a,t)}},{key:"pushData",value:function(e,t){var a=e.push(t);return a}},{key:"setData",value:function(e,t,a){var n=e.child(a),r=JSON.stringify(t);n.set(r)}},{key:"deleteData",value:function(e,t){var a=e.child(t);a.remove()}},{key:"uploadImage",value:function(e,t,a){var n=e.child(a),r=n.put(t);r&&this.showProgress(r)}},{key:"showProgress",value:function(e){console.log(e)}}],[{key:"init",value:function(t){return console.log("firebase init."),new e(t)}}]),e}(),C=R,I={connectFirebase:function(e){var t={apiKey:"AIzaSyAwxa81wGhmDu_1KmoVUi48jIcxaNW5yHU",authDomain:"draw-talk.firebaseapp.com",databaseURL:"https://draw-talk.firebaseio.com",projectId:"draw-talk",storageBucket:"draw-talk.appspot.com",messagingSenderId:"920241367747",appId:"1:920241367747:web:45f7324d9619bfa92d5076",measurementId:"G-3TEQSWT2FD"},a=C.init(t),n=a.getDBInfo();e.commit("initFirebase",n)},pushObjectsFireBase:function(e,t){var a=e.state.firebase.inst,n=e.state.firebase.objectsRef;if(void 0!==a)return void 0!==n?a.pushData(n,t):void 0}},x={};n["a"].use(m["a"]);var D=new m["a"].Store({state:j,mutations:k,actions:I,getters:x,modules:{}}),S=a("8c4f"),P=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"l-main"},[a("div",{staticClass:"p-home"},[a("App")],1)])},L=[],A=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e._v(" Home "),a("FabricCanvas")],1)},B=[],J=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("canvas",{attrs:{id:"fabricCavas"}})},E=[],K=function(e){Object(c["a"])(a,e);var t=Object(s["a"])(a);function a(){return Object(o["a"])(this,a),t.apply(this,arguments)}return a}(f["b"]);K=Object(u["__decorate"])([Object(f["a"])({components:{}})],K);var M=K,$=M,N=Object(d["a"])($,J,E,!1,null,null,null),T=N.exports,U=function(e){Object(c["a"])(a,e);var t=Object(s["a"])(a);function a(){return Object(o["a"])(this,a),t.apply(this,arguments)}return a}(f["b"]);U=Object(u["__decorate"])([Object(f["a"])({components:{FabricCanvas:T}})],U);var V=U,z=V,G=Object(d["a"])(z,A,B,!1,null,null,null),H=G.exports,W=function(e){Object(c["a"])(a,e);var t=Object(s["a"])(a);function a(){return Object(o["a"])(this,a),t.apply(this,arguments)}return a}(f["b"]);W=Object(u["__decorate"])([Object(f["a"])({components:{App:H}})],W);var Q=W,q=Q,X=Object(d["a"])(q,P,L,!1,null,null,null),Y=X.exports;n["a"].use(S["a"]);var Z=[{path:"/*",name:"home",component:Y},{path:"/:*",redirect:{name:"home"}}],ee=new S["a"]({mode:"history",routes:Z}),te=ee;new n["a"]({router:te,store:D,render:function(e){return e(p)},mounted:function(){D.dispatch("connectFirebase"),D.commit("attachFireBaseListner"),D.commit("initFabricJs"),D.commit("attachFabricJsListner")}}).$mount("#app")},"709f":function(e,t,a){"use strict";a("4e33")}});